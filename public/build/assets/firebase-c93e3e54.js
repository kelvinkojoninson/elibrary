var g={apiKey:"AIzaSyBvScYnlTjo6qUIbz83jwvl_G6K3ElaeVI",authDomain:"shaxigh.firebaseapp.com",databaseURL:"https://shaxigh.firebaseio.com",projectId:"shaxigh",storageBucket:"shaxigh.appspot.com",messagingSenderId:"907567908080",appId:"1:907567908080:web:3fbaba9c4c13f8faf42e35"};firebase.initializeApp(g);const l=firebase.messaging(),u=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js").then(function(t){console.log("Service Worker registered with scope:",t.scope)}).catch(function(t){console.error("Service Worker registration failed:",t)})},c=(t,e,o,i="")=>`
        <div id="${t}" class="toast mb-2" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="20000">
            <div class="toast-header">
                <img src="${APP_URL+"/favicon.png"}" height="30" class="rounded me-2" alt="">
                <strong class="me-auto">${e}</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            ${i?`<a href="${i}" class="text-gray-700" target="_blank"><div class="toast-body">${o}</div></a>`:`<div class="toast-body">${o}</div>`}
        </div>`,f=t=>{const e=document.getElementById(t);e&&new bootstrap.Toast(e).show()},m=async t=>{const e=uuidv4();var o="";try{let n=new FormData;n.append("token",t);const d=await fetch(APP_URL+"/api/users/fcm-token",{method:"POST",headers:{Authorization:`Bearer ${apiToken}`,"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:n}),{ok:r,msg:s}=await d.json();if(!r){o=c(e,"Notifications",s);return}o=c(e,"Notifications",s)}catch(n){o=c(e,"Notifications",n.message)}const i=document.createElement("div");i.innerHTML=o;const a=document.getElementById("toast-container");a&&a.appendChild(i),f(e)},h=async()=>{Notification.permission!=="granted"&&Notification.requestPermission().then(function(t){if(t==="granted")return l.getToken();throw new Error("Notification permission denied")}).then(function(t){console.log("Token:",t),m(t)}).catch(function(t){console.log("Token Error:",t)}),l.onMessage(t=>{const e=t.notification.title,o=t.notification.body,i=t.data.url,a=uuidv4(),n=c(a,e,o,i);new Notification(e,{body:o,icon:t.notification.icon}).addEventListener("click",()=>{i&&window.open(i,"_blank")});const r=document.createElement("div");r.innerHTML=n;const s=document.getElementById("toast-container");s&&s.appendChild(r),f(a)})};u();h();
